<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T√†i Nguy√™n THP - Qu·∫£n l√Ω t√†i nguy√™n</title>
    <script>
        (function () {
            try {
                const host = window.location.hostname;
                const isLocal = host === 'localhost' || host === '127.0.0.1' || host.endsWith('.local');
                if (!isLocal && window.location.protocol === 'http:') {
                    window.location.replace('https://' + window.location.host + window.location.pathname + window.location.search + window.location.hash);
                }
            } catch (e) {
                // ignore
            }
        })();
    </script>
    <script>
        (function () {
            try {
                const saved = localStorage.getItem('theme');
                const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                const useDark = saved ? saved === 'dark' : prefersDark;
                if (useDark) document.documentElement.classList.add('dark-mode');
            } catch (e) {
                // ignore
            }
        })();
    </script>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body class="has-header">
    <div class="theme-toggle">
        <button id="themeToggle" class="theme-btn"><span>Ch·∫ø ƒë·ªô t·ªëi</span></button>
    </div>

    <div class="header">
        <div class="header-content">
            <h1>Qu·∫£n l√Ω t√†i nguy√™n</h1>
            <p class="header-subtitle">Th√™m, ch·ªânh s·ª≠a v√† qu·∫£n l√Ω t√†i nguy√™n c·ªßa b·∫°n</p>
        </div>
        <button id="logoutBtn" class="btn btn-secondary">ƒêƒÉng xu·∫•t</button>
    </div>

    <div class="container">
        <div class="admin-panel">
            <div class="stats-grid">
                <div class="stat-card stat-primary">
                    <div class="stat-icon">üì¶</div>
                    <div class="stat-info">
                        <div class="stat-value" id="totalResources">0</div>
                        <div class="stat-label">T·ªïng t√†i nguy√™n</div>
                    </div>
                </div>
                <div class="stat-card stat-success">
                    <div class="stat-icon">‚úì</div>
                    <div class="stat-info">
                        <div class="stat-value" id="todayAdded">0</div>
                        <div class="stat-label">Th√™m h√¥m nay</div>
                    </div>
                </div>
                <div class="stat-card stat-warning">
                    <div class="stat-icon">üîó</div>
                    <div class="stat-info">
                        <div class="stat-value" id="totalLinks">0</div>
                        <div class="stat-label">T·ªïng links</div>
                    </div>
                </div>
            </div>

            <div class="add-section">
                <h2>Th√™m t√†i nguy√™n m·ªõi</h2>
                <form id="addResourceForm" class="form">
                    <div class="form-group">
                        <label for="resourceName">T√™n t√†i nguy√™n</label>
                        <input type="text" id="resourceName" required>
                    </div>
                    <div class="form-group">
                        <label for="resourceLink">Link t·∫£i</label>
                        <input type="url" id="resourceLink" required>
                    </div>
                    <div class="form-group">
                        <label for="resourceDescription">M√¥ t·∫£ (t√πy ch·ªçn)</label>
                        <textarea id="resourceDescription" rows="3"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Th√™m t√†i nguy√™n</button>
                </form>
            </div>

            <div class="resource-list">
                <div class="list-header">
                    <h2>Danh s√°ch t√†i nguy√™n</h2>
                    <div class="list-controls">
                        <input type="text" id="adminSearchInput" placeholder="T√¨m ki·∫øm..." class="search-input-mini">
                        <select id="sortSelect" class="sort-select">
                            <option value="newest">M·ªõi nh·∫•t</option>
                            <option value="oldest">C≈© nh·∫•t</option>
                            <option value="name">T√™n A-Z</option>
                        </select>
                    </div>
                </div>
                <div id="resourcesContainer"></div>
            </div>
        </div>
    </div>

    <div id="editModal" class="modal">
        <div class="modal-content">
            <h2>Ch·ªânh s·ª≠a t√†i nguy√™n</h2>
            <form id="editResourceForm" class="form">
                <input type="hidden" id="editResourceId">
                <div class="form-group">
                    <label for="editResourceName">T√™n t√†i nguy√™n</label>
                    <input type="text" id="editResourceName" required>
                </div>
                <div class="form-group">
                    <label for="editResourceLink">Link t·∫£i</label>
                    <input type="url" id="editResourceLink" required>
                </div>
                <div class="form-group">
                    <label for="editResourceDescription">M√¥ t·∫£</label>
                    <textarea id="editResourceDescription" rows="3"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">L∆∞u thay ƒë·ªïi</button>
                    <button type="button" id="closeModal" class="btn btn-secondary">H·ªßy</button>
                </div>
            </form>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth-compat.js"></script>
    <script src="../js/firebaseConfig.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/firebaseDb.js"></script>
    <script src="../js/admin.js"></script>
</body>
</html>
